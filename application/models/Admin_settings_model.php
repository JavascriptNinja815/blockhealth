<?phpclass Admin_settings_model extends CI_Model {    public function update_password_model() {        $this->form_validation->set_rules('current_password', 'Current Password', 'required');        $this->form_validation->set_rules('new_password', 'New Password', 'required');        $this->form_validation->set_rules('repeat_new_password', 'Re-Enter Password', 'required|matches[new_password]');        if ($this->form_validation->run()) {            $data = $this->input->post();            $table = "";            $id = "";            if ($this->session->userdata("login_role") == "clinic_admin") {                $table = "clinic_user_info";                $id = $this->session->userdata("user_id");            } else if ($this->session->userdata("login_role") == "clinic_physician") {                $table = "clinic_physician_info";                $id = $this->session->userdata("physician_id");            } else {                return "Invalid Access Attempt";            }            $this->db->select("id, password");            $this->db->where(                    array(                        "active" => 1,                        "id" => $id                    )            );            $this->db->from($table);            $result = $this->db->get()->result();            if ($result) {                $enc_password = $result[0]->password;                $new_password = $data["new_password"];                //check with current password                if (password_verify($data["current_password"], $enc_password)) {                    $this->db->where(                            array(                                "id" => $result[0]->id                            )                    );                    $this->db->update($table, array(                        "password" => password_hash($new_password, PASSWORD_BCRYPT)                            )                    );                    return true;                } else {                    return "Current Password is Incorrect";                }            }            return ($this->db->affected_rows() == 1) ? true : "Password not changed";        } else            return validation_errors();    }}